(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{134:function(e,t,c){},162:function(e,t,c){"use strict";c.r(t);var n,s=c(0),r=c.n(s),a=c(12),i=c.n(a),o=c(15),j=c.n(o),l=c(8),b=c(4),d=(c(34),c(134),c(175)),O=c(176),u=c(177),h=c(178),m=c(167),x=c(1),f=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{children:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f"}),Object(x.jsx)(b.q,{style:{height:"1000px"},children:Object(x.jsx)(b.C,{icon:Object(x.jsx)(m.a,{width:56,height:56})})})]})},g=c(17),p=c(20),v=Object(s.createContext)(),w=function(e){var t=e.children,c=Object(s.useState)([]),n=Object(l.a)(c,2),r=n[0],a=n[1],i=Object(s.useState)(1),o=Object(l.a)(i,2),j=o[0],b=o[1],d=Object(s.useState)(0),O=Object(l.a)(d,2),u=O[0],h=O[1],m=Object(s.useState)(15),f=Object(l.a)(m,1)[0],w=Object(s.useState)(!0),S=Object(l.a)(w,2),y=S[0],C=S[1],N=Object(s.useState)(!1),E=Object(l.a)(N,2),k=E[0],H=E[1];Object(s.useEffect)((function(){y&&p.get("https://jsonplaceholder.typicode.com/posts?_limit=".concat(f,"&_page=").concat(j)).then((function(e){a([].concat(Object(g.a)(r),Object(g.a)(e.data.filter((function(e){return r.findIndex((function(t){return t.id==e.id}))<0}))))),b((function(e){return e+1})),h(e.headers["x-total-count"])})).finally((function(){H(!1),C(!1)}))}),[y]),Object(s.useEffect)((function(){return window.addEventListener("scroll",P),function(){window.removeEventListener("scroll",P)}}),[]),Object(s.useEffect)((function(){k&&r.length<u&&C(!0)}),[k]);var P=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&H(!0)};return Object(x.jsx)(v.Provider,{value:{chats:r,fetching:y},children:t})},S=function(e){var t=e.onChatOpen,c=Object(s.useContext)(v),n=c.chats,r=c.fetching;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{className:"shadowPanelHeader",separator:!1,children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(x.jsx)(b.q,{children:Object(x.jsxs)(b.v,{children:[n.map((function(e){return Object(x.jsx)(b.F,{before:Object(x.jsx)(b.s,{gradientColor:Object(b.S)(e.id),children:e.title.substring(0,2)}),onClick:function(){return t(e)},subtitle:Object(x.jsxs)(x.Fragment,{children:[(c="\u0410\u043b\u0435\u043a\u0441\u0435\u0439: \u0441\u0442\u0438\u043a\u0435\u0440 cnbrth cnbrth cnbrth cnbrt",n=25,c.length>n?c.substring(0,n)+"...":c)," \xb7 2h"]}),indicator:Object(x.jsx)(b.i,{mode:"primary",children:"10"}),children:e.title.substring(0,10)},e.id);var c,n})),r&&Object(x.jsx)(b.G,{})]})})]})},y=c(168),C=c(169),N=c(172),E=c(173),k=c(170),H=c(171),P=c(20),T=c.n(P),B=function(e,t){var c=Object(s.useState)((function(){var c=localStorage.getItem(t);return c?JSON.parse(c):e})),n=Object(l.a)(c,2),r=n[0],a=n[1];return Object(s.useEffect)((function(){localStorage.setItem(t,JSON.stringify(r))}),r),[r,a]},L=function(e){var t,c=e.user,n=e.hasBack,r=e.onClose,a=Object(s.useState)(null),i=Object(l.a)(a,2),o=i[0],j=i[1],d=B(null,"user"),O=Object(l.a)(d,1)[0];return Object(s.useEffect)((function(){T.a.get("https://b451dbd8trial-dev-dice.cfapps.us10.hana.ondemand.com/main/Users/".concat(c)).then((function(e){j(e.data)}))}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{className:"shadowPanelHeader",separator:!1,before:n&&Object(x.jsx)(b.z,{onClick:r}),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),!o&&Object(x.jsx)(b.q,{children:Object(x.jsx)(b.G,{})}),o&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(b.q,{children:[Object(x.jsxs)(b.p,{mode:"tint",to:"top",className:"profileBIO",children:[Object(x.jsx)(b.s,{size:96,gradientColor:Object(b.S)(Number(o.phoneNumber%10)),children:o.username.substring(0,2)}),Object(x.jsx)(b.N,{level:"2",width:"2",className:"profileTitle",children:o.username}),Object(x.jsx)(b.L,{className:"profileSubTitle",children:o.bio}),O!=o.ID&&Object(x.jsxs)(b.e,{children:[Object(x.jsx)(b.d,{size:"m",sizeY:"compact",children:Object(x.jsx)(y.a,{})}),Object(x.jsx)(b.d,{size:"m",sizeY:"compact",before:Object(x.jsx)(C.a,{}),children:"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c"})]})]}),Object(x.jsx)(b.q,{header:Object(x.jsx)(b.r,{mode:"secondary",children:"\u0414\u0440\u0443\u0437\u044c\u044f"}),children:Object(x.jsx)(b.F,{className:"profileFriends",before:Object(x.jsx)(b.O,{size:"m",photos:["https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg","https://www.ixbt.com/img/n1/news/2018/7/4/341109.png","https://cdni.rt.com/russian/images/2022.09/article/63231abe02e8bd743524f678.png"]}),after:Object(x.jsx)(k.a,{width:30,height:30}),children:"1377 \u0434\u0440\u0443\u0437\u0435\u0439"})})]}),Object(x.jsxs)(b.q,{header:Object(x.jsx)(b.r,{mode:"secondary",children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:[Object(x.jsx)(b.w,{before:Object(x.jsx)(H.a,{}),textLevel:"primary",children:o.phoneNumber}),Object(x.jsx)(b.w,{before:Object(x.jsx)(N.a,{}),textLevel:"primary",children:o.email}),Object(x.jsx)(b.w,{before:Object(x.jsx)(E.a,{}),textLevel:"primary",children:(t=o.dateOfBirth,new Date(t).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric"}))})]}),Object(x.jsx)(b.q,{header:Object(x.jsx)(b.r,{mode:"secondary",children:"\u041b\u044e\u0431\u0438\u043c\u044b\u0435 \u0438\u0433\u0440\u044b"}),children:Object(x.jsxs)(b.v,{children:[Object(x.jsx)(b.f,{before:Object(x.jsx)(b.c,{src:"https://s2-goods.ozstatic.by/2000/42/893/10/10893042_0.jpg"}),description:"Carcassonne",children:"\u041a\u0430\u0440\u043a\u0430\u0441\u0441\u043e\u043d"}),Object(x.jsx)(b.f,{before:Object(x.jsx)(b.c,{src:"https://avatars.mds.yandex.net/get-mpic/6382710/img_id8546741754982085445.jpeg/orig"}),description:"Monopoly",children:"\u041c\u043e\u043d\u043e\u043f\u043e\u043b\u0438\u044f"}),Object(x.jsx)(b.f,{before:Object(x.jsx)(b.c,{src:"https://igromaster.by/upload/iblock/972/972ee18fcf89183f221bab04bcff0668.jpg"}),description:"Uno",children:"\u0423\u0301\u043d\u043e"})]})})]})]})},D=c(50),z=c(32),I=c.n(z),M=Object(s.createContext)(),F=function(){return Object(s.useContext)(M)},q=function(e){var t=e.children,c=e.chat,r=Object(s.useState)([]),a=Object(l.a)(r,2),i=a[0],o=a[1],j=Object(s.useState)([]),b=Object(l.a)(j,2),d=b[0],O=b[1],u=Object(s.useState)(!0),h=Object(l.a)(u,2),m=h[0],f=h[1],p=Object(s.useState)(1),v=Object(l.a)(p,2),w=v[0],S=v[1],y=Object(s.useState)(0),C=Object(l.a)(y,2),N=C[0],E=C[1],k=Object(s.useState)(30),H=Object(l.a)(k,1)[0],P=Object(s.useState)(!1),B=Object(l.a)(P,2),L=B[0],z=B[1],F=Object(s.useState)(!0),q=Object(l.a)(F,2),J=q[0],A=q[1],K=Object(s.useState)(2),_=Object(l.a)(K,2),Y=_[0],G=_[1],R=Object(s.useState)(!1),U=Object(l.a)(R,2),W=U[0],X=U[1];Object(s.useEffect)(Object(D.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("https://b451dbd8trial-dev-dice.cfapps.us10.hana.ondemand.com/main/Users");case 2:t=e.sent,O(Object(g.a)(t.data.value)),setTimeout((function(){Q()}),500);case 5:case"end":return e.stop()}}),e)}))),[]),Object(s.useEffect)((function(){return(n=new WebSocket("ws://192.168.160.194:8087/hello")).addEventListener("opne",Z),function(){n.removeEventListener("opne",Z),n.close()}}),[]),Object(s.useEffect)((function(){m&&d.length>0&&Q()}),[m]),Object(s.useEffect)((function(){c.members=d}),[d]);var Q=function(){T.a.get("https://jsonplaceholder.typicode.com/comments?_limit=".concat(H,"&_page=").concat(w)).then((function(e){o([].concat(Object(g.a)(e.data),Object(g.a)(i))),S((function(e){return e+1})),E(e.headers["x-total-count"])})).finally((function(){z(!1),f(!1),1==w&&window.scrollTo(window.scrollX,document.body.scrollHeight)}))};Object(s.useEffect)((function(){return window.addEventListener("scroll",V),function(){window.removeEventListener("scroll",V)}}),[]),Object(s.useEffect)((function(){L&&i.length<N&&f(!0)}),[L]);var V=function(e){A(!1),e.target.documentElement.scrollTop<100&&z(!0),e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&A(!0)},Z=function(e){X(!0),console.log(e)};return Object(x.jsx)(M.Provider,{value:{messages:i,fetching:m,members:d,chat:c,needScroll:J,limit:H,currentPage:w,sendMessage:function(e){A(!0);var t={senderId:1,chatId:2,email:"test@test.test",body:e};n.send(JSON.stringify(t)),o([].concat(Object(g.a)(i),[t])),G((function(e){return e+1}))},endOfPage:L,newMessageCount:Y,openSocket:W},children:t})},J=function(e){var t=e.text;return Object(x.jsxs)("div",{className:"textSeparator",children:[Object(x.jsx)("div",{className:"line"}),Object(x.jsx)("div",{className:"text",children:t})]})},A=function(e){var t=e.self,c=void 0!==t&&t,n=e.text,s=e.caption,r=void 0===s?"":s,a=e.hasAvatar,i=void 0!==a&&a,o=e.avatar,j=e.title,l=e.id;return Object(x.jsxs)("div",{className:"messageBox ".concat(c?"self":""),children:[i&&o&&Object(x.jsx)(b.c,{size:25}),i&&!o&&Object(x.jsx)(b.s,{size:25,gradientColor:Object(b.S)(l),children:j.substring(0,2)}),Object(x.jsxs)("div",{className:"messageTextBox ".concat(c?"self":""),children:[!c&&Object(x.jsx)("div",{className:"messageTitle",children:j}),Object(x.jsx)("div",{children:n}),r&&Object(x.jsx)("div",{className:"messageCaption",children:r})]})]})},K=function(e){var t=e.isPublic,c=void 0===t||t,n=Object(s.useState)(0),a=Object(l.a)(n,2),i=a[0],o=a[1],j=F(),d=j.messages,O=j.fetching,u=j.needScroll,h=j.newMessageCount,m=j.endOfPage,f=Object(s.useState)(window.innerHeight),g=Object(l.a)(f,2),p=g[0],v=g[1],w=Object(s.useState)(!1),S=Object(l.a)(w,2),y=S[0],C=S[1],N=Object(s.useRef)(null);Object(s.useLayoutEffect)((function(){m&&window.scrollTo(window.scrollX,document.body.scrollTop+document.documentElement.scrollHeight-i),u&&N.current.scrollIntoView({behavior:"smooth"})}),[d]),Object(s.useLayoutEffect)((function(){m&&o(document.documentElement.scrollHeight)}),[m]),Object(s.useEffect)((function(){y&&(p-window.innerHeight>0&&window.scrollTo(window.scrollX,window.scrollY+p-window.innerHeight),p-window.innerHeight<0&&document.documentElement.scrollHeight-(document.documentElement.scrollTop+window.innerHeight)>Math.abs(p-window.innerHeight)&&window.scrollTo(window.scrollX,window.scrollY+p-window.innerHeight),v(window.innerHeight),C(!1))}),[y]);var E=function(){C(!0)};return Object(s.useEffect)((function(){return window.addEventListener("resize",E),function(){return window.removeEventListener("resize",E)}}),[]),Object(x.jsxs)(x.Fragment,{children:[O&&Object(x.jsx)(b.G,{style:{marginTop:10}}),Object(x.jsx)("div",{className:"messageList",children:d.map((function(e,t,n){return Object(x.jsxs)(r.a.Fragment,{children:[n.length-t==h&&Object(x.jsx)(J,{text:"\u041d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(x.jsx)(A,{text:e.body,caption:e.id,hasAvatar:e.id%2==1&&c,self:e.id%2==0,title:c&&e.email,avatar:e.avatar,id:e.id})]},t)}))}),Object(x.jsx)("div",{ref:N})]})},_=c(174),Y=function(e){var t=e.onClose,c=e.onOpenChatMembersList,n=Object(s.useState)(""),r=Object(l.a)(n,2),a=r[0],i=r[1],o=Object(s.useState)(0),j=Object(l.a)(o,2),d=j[0],O=j[1],u=Object(s.useRef)(),h=F(),m=h.chat,f=h.sendMessage,g=h.openSocket,p=h.members;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{className:"shadowPanelHeader",separator:!1,before:Object(x.jsx)(b.z,{onClick:t}),after:p.length>0&&Object(x.jsx)(b.A,{onClick:c,children:Object(x.jsx)(_.a,{})}),children:Object(x.jsx)(b.B,{before:Object(x.jsx)(b.s,{size:36,gradientColor:Object(b.S)(m.id),children:m.title.substring(0,2)}),status:"".concat(p.length," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),children:m.title.substring(0,10)})}),Object(x.jsx)(K,{}),Object(x.jsx)(b.l,{vertical:"bottom",style:{paddingBottom:0},children:Object(x.jsxs)("div",{ref:u,children:[Object(x.jsx)(b.E,{wide:!0}),Object(x.jsx)(b.Q,{value:a,onChange:function(e){return i(e.target.value)},onHeightChange:function(){return function(){var e=u.current;if(e){var t=e.offsetHeight;t!==d&&O(t)}}()},placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",after:Object(x.jsx)(s.Fragment,{children:Object(x.jsx)(b.R,{mode:"send",disabled:0===a.length||!g,onClick:function(){return f(a),void i("")}})})})]})})]})},G=function(e){var t=e.onClose,c=e.chat,n=e.onOpenProfile;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{className:"shadowPanelHeader",separator:!1,before:Object(x.jsx)(b.z,{onClick:t}),children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438"}),Object(x.jsxs)(b.q,{className:"d-f-center",children:[Object(x.jsx)(b.s,{size:100,gradientColor:Object(b.S)(c.id),children:c.title.substring(0,2)}),Object(x.jsx)(b.N,{children:c.title.substring(0,10)})]}),Object(x.jsx)(b.q,{children:Object(x.jsx)(b.v,{children:c.members.map((function(e){return Object(x.jsx)(b.F,{before:Object(x.jsx)(b.s,{size:48,gradientColor:Object(b.S)(Number(e.phoneNumber%10)),children:e.username.substring(0,2)}),subtitle:e.bio,onClick:function(){return n(e.ID)},children:e.username},e.ID)}))})})]})},R=c(55),U=function(){return Object(x.jsx)("div",{className:"mapMarkerWrapper",children:Object(x.jsxs)("div",{onClick:function(e){e.stopPropagation(),console.log(e.target),e.target.focus()},onTouchStart:function(e){e.stopPropagation(),e.target.closest(".mapMarkerInner").classList.add("touch"),setTimeout((function(){e.target.closest(".mapMarkerInner").classList.remove("touch")}),100)},className:"mapMarkerInner",children:[Object(x.jsx)("div",{className:"mapMarkerInfo",children:Object(x.jsxs)("div",{className:"mapMarkerContent",children:[Object(x.jsx)("div",{className:"mapMarkerTitle",children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438\u0432\u0435\u043d\u0442\u0430"}),Object(x.jsx)("div",{className:"mapMarkerText",children:"10.09.2022 10:00"})]})}),Object(x.jsx)("div",{className:"mapBottom"})]})})},W=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),c=t[0];t[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.y,{separator:!1,className:"shadowPanelHeader",children:"\u041a\u0430\u0440\u0442\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"}),Object(x.jsxs)(b.q,{className:"mapGroup",children:[!c&&Object(x.jsx)(b.G,{}),c&&Object(x.jsxs)(R.a,{bootstrapURLKeys:{key:"AIzaSyBY3XkvjucuJx55bzFZMTJQnYH5JnWK8SQ"},defaultCenter:{lat:53.90478949220637,lng:27.54735640149058},defaultZoom:17,children:[Object(x.jsx)(U,{lat:53.90478949220637,lng:27.54735640149058}),Object(x.jsx)(U,{lat:53.886469185056136,lng:27.53915628552071}),Object(x.jsx)(U,{lat:53.887077641997124,lng:27.535944819314054}),Object(x.jsx)(U,{lat:53.88911935332895,lng:27.536236386276723})]})]})]})},X=function(){var e=Object(s.useState)("bright_light"),t=Object(l.a)(e,2),c=t[0],n=(t[1],Object(s.useState)("map")),r=Object(l.a)(n,2),a=r[0],i=r[1],o=Object(s.useState)("messages"),j=Object(l.a)(o,2),m=j[0],g=j[1],p=Object(s.useState)(null),v=Object(l.a)(p,2),y=v[0],C=v[1],N=Object(s.useState)(!0),E=Object(l.a)(N,2),k=E[0],H=E[1],P=B(null,"user"),T=Object(l.a)(P,1)[0],D=Object(s.useState)(T),z=Object(l.a)(D,2),I=z[0],M=z[1],F=function(e){return i(e.currentTarget.dataset.story)};return Object(x.jsx)(b.h,{scheme:c,webviewType:"internal",children:Object(x.jsx)(b.a,{children:Object(x.jsx)(b.b,{children:Object(x.jsx)(b.I,{header:Object(x.jsx)(b.y,{separator:!1}),style:{justifyContent:"center"},children:Object(x.jsx)(b.H,{animate:!0,spaced:!1,width:"100%",maxWidth:"100%",children:Object(x.jsxs)(b.k,{activeStory:a,tabbar:k&&Object(x.jsxs)(b.J,{children:[Object(x.jsx)(b.K,{onClick:F,selected:"events"===a,"data-story":"events",text:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f",children:Object(x.jsx)(d.a,{})}),Object(x.jsx)(b.K,{onClick:F,selected:"map"===a,"data-story":"map",text:"\u041a\u0430\u0440\u0442\u0430",children:Object(x.jsx)(O.a,{})}),Object(x.jsx)(b.K,{onClick:F,selected:"messages"===a,"data-story":"messages",text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",children:Object(x.jsx)(u.a,{})}),Object(x.jsx)(b.K,{onClick:F,selected:"profile"===a,"data-story":"profile",text:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",children:Object(x.jsx)(h.a,{})})]}),children:[Object(x.jsx)(b.P,{id:"events",activePanel:"events",children:Object(x.jsx)(b.x,{id:"events",children:Object(x.jsx)(f,{})})}),Object(x.jsx)(b.P,{id:"map",activePanel:"map",children:Object(x.jsx)(b.x,{id:"map",children:Object(x.jsx)(W,{})})}),Object(x.jsxs)(b.P,{id:"messages",activePanel:m,children:[Object(x.jsx)(b.x,{id:"messages",children:Object(x.jsx)(w,{children:Object(x.jsx)(S,{onChatOpen:function(e){C(e),g("chat"),H(!1)}})})}),Object(x.jsx)(b.x,{id:"chat",className:"chatPanel",children:Object(x.jsx)(q,{chat:y,children:Object(x.jsx)(Y,{onClose:function(){g("messages"),H(!0)},onOpenChatMembersList:function(e){g("chatMembers")}})})}),Object(x.jsx)(b.x,{id:"chatMembers",children:Object(x.jsx)(G,{onOpenProfile:function(e){M(e),i("profile")},chat:y,onClose:function(){g("chat")}})})]}),Object(x.jsx)(b.P,{id:"profile",activePanel:"profile",children:Object(x.jsx)(b.x,{id:"profile",children:Object(x.jsx)(L,{hasBack:!k,onClose:function(){M(T),i("messages")},user:I})})})]})})})})})})},Q=c(52),V=c(26),Z=c(27),$=c(22),ee=c(54),te=c(53);r.a.Component;j.a.send("VKWebAppInit"),localStorage.setItem("user",JSON.stringify("027b4656-bccc-4a0a-9508-6a9ae173bb95")),i.a.render(Object(x.jsx)(X,{}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.253ca2cc.chunk.js.map