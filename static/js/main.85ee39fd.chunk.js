(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{138:function(e,t,c){},164:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c.n(n),i=c(19),r=c.n(i),o=c(11),a=c.n(o),j=c(8),l=c(4),d=(c(137),c(138),c(166)),b=c(167),u=c(168),O=c(165),h=c(1),x=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.q,{children:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f"}),Object(h.jsx)(l.j,{style:{height:"1000px"},children:Object(h.jsx)(l.t,{icon:Object(h.jsx)(O.a,{width:56,height:56})})})]})},f=c(14),D=c(24),p=Object(n.createContext)(),g=function(e){var t=e.children,c=Object(n.useState)([]),s=Object(j.a)(c,2),i=s[0],r=s[1],o=Object(n.useState)(1),a=Object(j.a)(o,2),l=a[0],d=a[1],b=Object(n.useState)(0),u=Object(j.a)(b,2),O=u[0],x=u[1],g=Object(n.useState)(15),m=Object(j.a)(g,1)[0],w=Object(n.useState)(!0),B=Object(j.a)(w,2),v=B[0],A=B[1],E=Object(n.useState)(!1),C=Object(j.a)(E,2),y=C[0],S=C[1];Object(n.useEffect)((function(){v&&D.get("https://jsonplaceholder.typicode.com/posts?_limit=".concat(m,"&_page=").concat(l)).then((function(e){r([].concat(Object(f.a)(i),Object(f.a)(e.data.filter((function(e){return i.findIndex((function(t){return t.id==e.id}))<0}))))),d((function(e){return e+1})),x(e.headers["x-total-count"])})).finally((function(){S(!1),A(!1)}))}),[v]),Object(n.useEffect)((function(){return window.addEventListener("scroll",H),function(){window.removeEventListener("scroll",H)}}),[]),Object(n.useEffect)((function(){y&&i.length<O&&A(!0)}),[y]);var H=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&S(!0)};return Object(h.jsx)(p.Provider,{value:{chats:i,fetching:v},children:t})},m=function(e){var t=e.onChatOpen,c=Object(n.useContext)(p),s=c.chats,i=c.fetching;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.q,{className:"shadowPanelHeader",separator:!1,children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(h.jsx)(l.j,{children:Object(h.jsxs)(l.o,{children:[s.map((function(e){return Object(h.jsx)(l.w,{before:Object(h.jsx)(l.n,{gradientColor:Object(l.F)(e.id),children:e.title.substring(0,2)}),onClick:function(){return t(e)},subtitle:Object(h.jsxs)(h.Fragment,{children:[(c="\u0410\u043b\u0435\u043a\u0441\u0435\u0439: \u0441\u0442\u0438\u043a\u0435\u0440 cnbrth cnbrth cnbrth cnbrt",n=25,c.length>n?c.substring(0,n)+"...":c)," \xb7 2h"]}),indicator:Object(h.jsx)(l.g,{mode:"primary",children:"10"}),children:e.title.substring(0,10)},e.id);var c,n})),i&&Object(h.jsx)(l.x,{})]})})]})},w=function(){return Object(h.jsxs)(l.j,{children:[Object(h.jsx)(l.q,{children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(h.jsx)(l.u,{disabled:!0,before:Object(h.jsx)(l.c,{size:100,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"}),caption:"Lesta Games(\u0422\u0435\u0445\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430)",actions:Object(h.jsxs)(l.j,{children:[Object(h.jsx)(l.d,{style:{margin:"5px"},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),Object(h.jsx)(l.d,{style:{margin:"5px"},children:"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c"})]}),children:"\u0412\u0430\u043d\u044f \u0421\u0430\u043a\u0443\u043d"}),Object(h.jsx)(l.j,{header:Object(h.jsx)(l.k,{mode:"secondary",children:"\u0414\u0440\u0443\u0437\u044c\u044f"}),children:Object(h.jsx)(l.m,{showArrows:!0,getScrollToLeft:function(e){return e-120},getScrollToRight:function(e){return e+120},children:Object(h.jsxs)("div",{style:{display:"flex"},children:[Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},1),Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},2),Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},3),Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},4),Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},5),Object(h.jsx)(l.l,{header:"ABOBA",children:Object(h.jsx)(l.c,{size:56,src:"https://www.iphones.ru/wp-content/uploads/2021/09/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA-%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0-2021-09-07-%D0%B2-19.48.05.jpg"})},6)]})})}),Object(h.jsx)(l.j,{header:Object(h.jsx)(l.k,{mode:"secondary",children:"\u041b\u044e\u0431\u0438\u043c\u044b\u0435 \u0438\u0433\u0440\u044b"}),children:Object(h.jsxs)(l.o,{children:[Object(h.jsx)(l.e,{before:Object(h.jsx)(l.c,{src:"https://s2-goods.ozstatic.by/2000/42/893/10/10893042_0.jpg"}),description:"Carcassonne",children:"\u041a\u0430\u0440\u043a\u0430\u0441\u0441\u043e\u043d"}),Object(h.jsx)(l.e,{before:Object(h.jsx)(l.c,{src:"https://avatars.mds.yandex.net/get-mpic/6382710/img_id8546741754982085445.jpeg/orig"}),description:"Monopoly",children:"\u041c\u043e\u043d\u043e\u043f\u043e\u043b\u0438\u044f"}),Object(h.jsx)(l.e,{before:Object(h.jsx)(l.c,{src:"https://igromaster.by/upload/iblock/972/972ee18fcf89183f221bab04bcff0668.jpg"}),description:"Uno",children:"\u0423\u0301\u043d\u043e"})]})})]})},B=c(42),v=c(25),A=c.n(v),E=c(24),C=c.n(E),y=Object(n.createContext)(),S=function(){return Object(n.useContext)(y)},H=function(e){var t=e.children,c=e.chat,s=Object(n.useState)([]),i=Object(j.a)(s,2),r=i[0],o=i[1],a=Object(n.useState)([]),l=Object(j.a)(a,2),d=l[0],b=l[1],u=Object(n.useState)(!0),O=Object(j.a)(u,2),x=O[0],D=O[1],p=Object(n.useState)(1),g=Object(j.a)(p,2),m=g[0],w=g[1],v=Object(n.useState)(0),E=Object(j.a)(v,2),S=E[0],H=E[1],T=Object(n.useState)(30),z=Object(j.a)(T,1)[0],k=Object(n.useState)(!1),P=Object(j.a)(k,2),L=P[0],N=P[1],F=Object(n.useState)(!0),_=Object(j.a)(F,2),M=_[0],q=_[1],I=Object(n.useState)(2),X=Object(j.a)(I,2),R=X[0],Y=X[1];Object(n.useEffect)(Object(B.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b([1]),setTimeout((function(){J()}),500);case 2:case"end":return e.stop()}}),e)}))),[]),Object(n.useEffect)((function(){x&&d.length>0&&J()}),[x]);var J=function(){C.a.get("https://jsonplaceholder.typicode.com/comments?_limit=".concat(z,"&_page=").concat(m)).then((function(e){o([].concat(Object(f.a)(e.data),Object(f.a)(r))),w((function(e){return e+1})),H(e.headers["x-total-count"])})).finally((function(){N(!1),D(!1),1==m&&window.scrollTo(window.scrollX,document.body.scrollHeight)}))};Object(n.useEffect)((function(){return window.addEventListener("scroll",V),function(){window.removeEventListener("scroll",V)}}),[]),Object(n.useEffect)((function(){L&&r.length<S&&D(!0)}),[L]);var V=function(e){q(!1),e.target.documentElement.scrollTop<100&&N(!0),e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&q(!0)};return Object(h.jsx)(y.Provider,{value:{messages:r,fetching:x,members:d,chat:c,needScroll:M,limit:z,currentPage:m,sendMessage:function(e){q(!0),o([].concat(Object(f.a)(r),[{userId:1,id:2,title:"sunt aut facere repellat provident occaecati excepturi optio reprehenderit",email:"test@test.test",body:e}])),Y((function(e){return e+1}))},endOfPage:L,newMessageCount:R},children:t})},T=function(e){var t=e.text;return Object(h.jsxs)("div",{className:"textSeparator",children:[Object(h.jsx)("div",{className:"line"}),Object(h.jsx)("div",{className:"text",children:t})]})},z=function(e){var t=e.self,c=void 0!==t&&t,n=e.text,s=e.caption,i=void 0===s?"":s,r=e.hasAvatar,o=void 0!==r&&r,a=e.avatar,j=e.title,d=e.id;return Object(h.jsxs)("div",{className:"messageBox ".concat(c?"self":""),children:[o&&a&&Object(h.jsx)(l.c,{size:25}),o&&!a&&Object(h.jsx)(l.n,{size:25,gradientColor:Object(l.F)(d),children:j.substring(0,2)}),Object(h.jsxs)("div",{className:"messageTextBox ".concat(c?"self":""),children:[!c&&Object(h.jsx)("div",{className:"messageTitle",children:j}),Object(h.jsx)("div",{children:n}),i&&Object(h.jsx)("div",{className:"messageCaption",children:i})]})]})},k=function(e){var t=e.isPublic,c=void 0===t||t,i=Object(n.useState)(0),r=Object(j.a)(i,2),o=r[0],a=r[1],d=S(),b=d.messages,u=d.fetching,O=d.needScroll,x=d.newMessageCount,f=d.endOfPage,D=Object(n.useState)(window.innerHeight),p=Object(j.a)(D,2),g=p[0],m=p[1],w=Object(n.useState)(!1),B=Object(j.a)(w,2),v=B[0],A=B[1],E=Object(n.useRef)(null);Object(n.useLayoutEffect)((function(){f&&window.scrollTo(window.scrollX,document.body.scrollTop+document.documentElement.scrollHeight-o),O&&E.current.scrollIntoView({behavior:"smooth"})}),[b]),Object(n.useLayoutEffect)((function(){f&&a(document.documentElement.scrollHeight)}),[f]),Object(n.useEffect)((function(){console.log(window.scrollY),console.log(g-window.innerHeight),v&&(g-window.innerHeight>0&&window.scrollTo(window.scrollX,window.scrollY+g-window.innerHeight),g-window.innerHeight<0&&document.documentElement.scrollHeight-(document.documentElement.scrollTop+window.innerHeight)>Math.abs(g-window.innerHeight)&&window.scrollTo(window.scrollX,window.scrollY+g-window.innerHeight),m(window.innerHeight),A(!1))}),[v]);var C=function(){A(!0)};return Object(n.useEffect)((function(){return window.addEventListener("resize",C),function(){return window.removeEventListener("resize",C)}}),[]),Object(h.jsxs)(h.Fragment,{children:[u&&Object(h.jsx)(l.x,{style:{marginTop:10}}),Object(h.jsx)("div",{className:"messageList",children:b.map((function(e,t,n){return Object(h.jsxs)(s.a.Fragment,{children:[n.length-t==x&&Object(h.jsx)(T,{text:"\u041d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(h.jsx)(z,{text:e.body,caption:e.id,hasAvatar:e.id%2==1&&c,self:e.id%2==0,title:c&&e.email,avatar:e.avatar,id:e.id})]},t)}))}),Object(h.jsx)("div",{ref:E})]})},P=function(e){var t=e.onClose,c=Object(n.useState)(""),s=Object(j.a)(c,2),i=s[0],r=s[1],o=Object(n.useState)(0),a=Object(j.a)(o,2),d=a[0],b=a[1],u=Object(n.useRef)(),O=S(),x=O.members,f=O.chat,D=O.sendMessage;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.q,{className:"shadowPanelHeader",separator:!1,before:Object(h.jsx)(l.r,{onClick:function(){return t()}}),children:Object(h.jsx)(l.s,{before:Object(h.jsx)(l.n,{size:36,gradientColor:Object(l.F)(f.id),children:f.title.substring(0,2)}),status:"".concat(x.length," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),children:f.title.substring(0,10)})}),Object(h.jsx)(k,{}),Object(h.jsx)(l.i,{vertical:"bottom",style:{paddingBottom:0},children:Object(h.jsxs)("div",{ref:u,children:[Object(h.jsx)(l.v,{wide:!0}),Object(h.jsx)(l.D,{value:i,onChange:function(e){return r(e.target.value)},onHeightChange:function(){return function(){var e=u.current;if(e){var t=e.offsetHeight;t!==d&&b(t)}}()},placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",after:Object(h.jsx)(n.Fragment,{children:Object(h.jsx)(l.E,{mode:"send",disabled:0===i.length,onClick:function(){return D(i),void r("")}})})})]})})]})},L=function(){var e=Object(n.useState)("bright_light"),t=Object(j.a)(e,2),c=t[0],i=(t[1],s.a.useState("events")),r=Object(j.a)(i,2),o=r[0],a=r[1],O=Object(n.useState)("messages"),f=Object(j.a)(O,2),D=f[0],p=f[1],B=Object(n.useState)(null),v=Object(j.a)(B,2),A=v[0],E=v[1],C=Object(n.useState)(!0),y=Object(j.a)(C,2),S=y[0],T=y[1],z=function(e){return a(e.currentTarget.dataset.story)};return Object(h.jsx)(l.f,{scheme:c,children:Object(h.jsx)(l.a,{children:Object(h.jsx)(l.b,{children:Object(h.jsx)(l.z,{header:Object(h.jsx)(l.q,{separator:!1}),style:{justifyContent:"center"},children:Object(h.jsx)(l.y,{animate:!0,spaced:!1,width:"100%",maxWidth:"100%",children:Object(h.jsxs)(l.h,{activeStory:o,tabbar:S&&Object(h.jsxs)(l.A,{children:[Object(h.jsx)(l.B,{onClick:z,selected:"events"===o,"data-story":"events",text:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f",children:Object(h.jsx)(d.a,{})}),Object(h.jsx)(l.B,{onClick:z,selected:"messages"===o,"data-story":"messages",text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",children:Object(h.jsx)(b.a,{})}),Object(h.jsx)(l.B,{onClick:z,selected:"profile"===o,"data-story":"profile",text:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",children:Object(h.jsx)(u.a,{})})]}),children:[Object(h.jsx)(l.C,{id:"events",activePanel:"events",children:Object(h.jsx)(l.p,{id:"events",children:Object(h.jsx)(x,{})})}),Object(h.jsxs)(l.C,{id:"messages",activePanel:D,children:[Object(h.jsx)(l.p,{id:"messages",children:Object(h.jsx)(g,{children:Object(h.jsx)(m,{onChatOpen:function(e){E(e),p("chat"),T(!1)}})})}),Object(h.jsx)(l.p,{id:"chat",className:"chatPanel",children:Object(h.jsx)(H,{chat:A,children:Object(h.jsx)(P,{onClose:function(){p("messages"),T(!0)}})})})]}),Object(h.jsx)(l.C,{id:"profile",activePanel:"profile",children:Object(h.jsx)(l.p,{id:"profile",children:Object(h.jsx)(w,{})})})]})})})})})})};a.a.send("VKWebAppInit"),r.a.render(Object(h.jsx)(L,{}),document.getElementById("root"))}},[[164,1,2]]]);
//# sourceMappingURL=main.85ee39fd.chunk.js.map