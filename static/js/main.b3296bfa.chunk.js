(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{145:function(e,t,c){},171:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c.n(n),i=c(19),a=c.n(i),r=c(10),j=c.n(r),o=c(8),l=c(4),b=(c(144),c(145),c(174)),d=c(175),O=c(173),u=c(172),h=c(1),x=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.l,{children:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f"}),Object(h.jsx)(l.h,{style:{height:"1000px"},children:Object(h.jsx)(l.o,{icon:Object(h.jsx)(u.a,{width:56,height:56})})})]})},f=c(14),m=c(24),g=Object(n.createContext)(),v=function(e){var t=e.children,c=Object(n.useState)([]),s=Object(o.a)(c,2),i=s[0],a=s[1],r=Object(n.useState)(1),j=Object(o.a)(r,2),l=j[0],b=j[1],d=Object(n.useState)(0),O=Object(o.a)(d,2),u=O[0],x=O[1],v=Object(n.useState)(15),p=Object(o.a)(v,1)[0],w=Object(n.useState)(!0),S=Object(o.a)(w,2),y=S[0],C=S[1],E=Object(n.useState)(!1),k=Object(o.a)(E,2),N=k[0],H=k[1];Object(n.useEffect)((function(){y&&m.get("https://jsonplaceholder.typicode.com/posts?_limit=".concat(p,"&_page=").concat(l)).then((function(e){a([].concat(Object(f.a)(i),Object(f.a)(e.data.filter((function(e){return i.findIndex((function(t){return t.id==e.id}))<0}))))),b((function(e){return e+1})),x(e.headers["x-total-count"])})).finally((function(){H(!1),C(!1)}))}),[y]),Object(n.useEffect)((function(){return window.addEventListener("scroll",P),function(){window.removeEventListener("scroll",P)}}),[]),Object(n.useEffect)((function(){N&&i.length<u&&C(!0)}),[N]);var P=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&H(!0)};return Object(h.jsx)(g.Provider,{value:{chats:i,fetching:y},children:t})},p=function(e){var t=e.onChatOpen,c=Object(n.useContext)(g),s=c.chats,i=c.fetching;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.l,{className:"shadowPanelHeader",separator:!1,children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(h.jsx)(l.h,{children:Object(h.jsxs)(l.j,{children:[s.map((function(e){return Object(h.jsx)(l.q,{before:Object(h.jsx)(l.i,{gradientColor:Object(l.z)(e.id),children:e.title.substring(0,2)}),onClick:function(){return t(e)},subtitle:Object(h.jsxs)(h.Fragment,{children:[(c="\u0410\u043b\u0435\u043a\u0441\u0435\u0439: \u0441\u0442\u0438\u043a\u0435\u0440 cnbrth cnbrth cnbrth cnbrt",n=25,c.length>n?c.substring(0,n)+"...":c)," \xb7 2h"]}),indicator:Object(h.jsx)(l.e,{mode:"primary",children:"10"}),children:e.title.substring(0,10)},e.id);var c,n})),i&&Object(h.jsx)(l.r,{})]})})]})},w=function(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.l,{children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(h.jsx)(l.h,{style:{height:"1000px"},children:Object(h.jsx)(l.o,{icon:Object(h.jsx)(O.a,{width:56,height:56})})})]})},S=c(42),y=c(25),C=c.n(y),E=c(24),k=c.n(E),N=Object(n.createContext)(),H=function(){return Object(n.useContext)(N)},P=function(e){var t=e.children,c=e.chat,s=Object(n.useState)([]),i=Object(o.a)(s,2),a=i[0],r=i[1],j=Object(n.useState)([]),l=Object(o.a)(j,2),b=l[0],d=l[1],O=Object(n.useState)(!0),u=Object(o.a)(O,2),x=u[0],m=u[1],g=Object(n.useState)(1),v=Object(o.a)(g,2),p=v[0],w=v[1],y=Object(n.useState)(0),E=Object(o.a)(y,2),H=E[0],P=E[1],T=Object(n.useState)(30),F=Object(o.a)(T,1)[0],z=Object(n.useState)(!1),L=Object(o.a)(z,2),_=L[0],B=L[1],A=Object(n.useState)(!0),I=Object(o.a)(A,2),J=I[0],W=I[1];Object(n.useEffect)(Object(S.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d([1]),setTimeout((function(){X()}),500);case 2:case"end":return e.stop()}}),e)}))),[]),Object(n.useEffect)((function(){x&&b.length>0&&X()}),[x]);var X=function(){k.a.get("https://jsonplaceholder.typicode.com/comments?_limit=".concat(F,"&_page=").concat(p)).then((function(e){r([].concat(Object(f.a)(e.data),Object(f.a)(a))),w((function(e){return e+1})),P(e.headers["x-total-count"])})).finally((function(){B(!1),m(!1),J&&window.scrollTo(window.scrollX,document.body.scrollHeight)}))};Object(n.useEffect)((function(){return window.addEventListener("scroll",q),function(){window.removeEventListener("scroll",q)}}),[]),Object(n.useEffect)((function(){_&&a.length<H&&m(!0)}),[_]);var q=function(e){W(!1),e.target.documentElement.scrollTop<100&&B(!0)};return Object(h.jsx)(N.Provider,{value:{messages:a,fetching:x,members:b,chat:c,needScroll:J,limit:F,currentPage:p},children:t})},T=function(e){var t=e.text;return Object(h.jsxs)("div",{className:"textSeparator",children:[Object(h.jsx)("div",{className:"line"}),Object(h.jsx)("div",{className:"text",children:t})]})},F=function(e){var t=e.self,c=void 0!==t&&t,n=e.text,s=e.caption,i=void 0===s?"":s,a=e.hasAvatar,r=void 0!==a&&a,j=e.avatar,o=e.title,b=e.id;return Object(h.jsxs)("div",{className:"messageBox ".concat(c?"self":""),children:[r&&j&&Object(h.jsx)(l.c,{size:25}),r&&!j&&Object(h.jsx)(l.i,{size:25,gradientColor:Object(l.z)(b),children:o.substring(0,2)}),Object(h.jsxs)("div",{className:"messageTextBox ".concat(c?"self":""),children:[!c&&Object(h.jsx)("div",{className:"messageTitle",children:o}),Object(h.jsx)("div",{children:n}),i&&Object(h.jsx)("div",{className:"messageCaption",children:i})]})]})},z=function(e){var t=e.isPublic,c=void 0===t||t,i=Object(n.useState)(0),a=Object(o.a)(i,2),r=a[0],j=a[1],b=H(),d=b.messages,O=b.fetching;b.needScroll,b.limit;return Object(n.useLayoutEffect)((function(){r?(window.scrollTo(window.scrollX,document.body.scrollTop+document.documentElement.scrollHeight-r),j(document.documentElement.scrollHeight)):j(document.documentElement.scrollHeight)}),[d]),Object(h.jsxs)(h.Fragment,{children:[O&&Object(h.jsx)(l.r,{style:{marginTop:10}}),Object(h.jsx)("div",{className:"messageList",children:d.map((function(e,t,n){return Object(h.jsxs)(s.a.Fragment,{children:[n.length-t==2&&Object(h.jsx)(T,{text:"\u041d\u043e\u0432\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"}),Object(h.jsx)(F,{text:e.body,caption:e.id,hasAvatar:e.id%2==1&&c,self:e.id%2==0,title:c&&e.email,avatar:e.avatar,id:e.id}),n[t+1]?e.id-n[t+1].id==59&&Object(h.jsx)(T,{text:"".concat(e.id-59,"-").concat(e.id-60+30)}):Object(h.jsx)(h.Fragment,{})]},t)}))})]})},L=function(e){var t=e.onClose,c=Object(n.useState)(""),s=Object(o.a)(c,2),i=s[0],a=s[1],r=Object(n.useState)(0),j=Object(o.a)(r,2),b=j[0],d=j[1],O=Object(n.useRef)(),u=H(),x=u.members,f=u.chat;u.needScroll,u.messages;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(l.l,{className:"shadowPanelHeader",separator:!1,before:Object(h.jsx)(l.m,{onClick:function(){return t()}}),children:Object(h.jsx)(l.n,{before:Object(h.jsx)(l.i,{size:36,gradientColor:Object(l.z)(f.id),children:f.title.substring(0,2)}),status:"".concat(x.length," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),children:f.title.substring(0,10)})}),Object(h.jsx)(z,{}),Object(h.jsx)(l.g,{vertical:"bottom",style:{paddingBottom:0},children:Object(h.jsxs)("div",{ref:O,children:[Object(h.jsx)(l.p,{wide:!0}),Object(h.jsx)(l.x,{value:i,onChange:function(e){return a(e.target.value)},onHeightChange:function(){return function(){var e=O.current;if(e){var t=e.offsetHeight;t!==b&&d(t)}}()},placeholder:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",after:Object(h.jsx)(n.Fragment,{children:Object(h.jsx)(l.y,{mode:"send",disabled:0===i.length})})})]})})]})},_=function(){var e=Object(n.useState)("bright_light"),t=Object(o.a)(e,2),c=t[0],i=(t[1],s.a.useState("messages")),a=Object(o.a)(i,2),r=a[0],j=a[1],u=Object(n.useState)("messages"),f=Object(o.a)(u,2),m=f[0],g=f[1],S=Object(n.useState)(null),y=Object(o.a)(S,2),C=y[0],E=y[1],k=Object(n.useState)(!0),N=Object(o.a)(k,2),H=N[0],T=N[1],F=function(e){return j(e.currentTarget.dataset.story)};return Object(h.jsx)(l.d,{scheme:c,children:Object(h.jsx)(l.a,{children:Object(h.jsx)(l.b,{children:Object(h.jsx)(l.t,{header:Object(h.jsx)(l.l,{separator:!1}),style:{justifyContent:"center"},children:Object(h.jsx)(l.s,{animate:!0,spaced:!1,width:"100%",maxWidth:"100%",children:Object(h.jsxs)(l.f,{activeStory:r,tabbar:H&&Object(h.jsxs)(l.u,{children:[Object(h.jsx)(l.v,{onClick:F,selected:"events"===r,"data-story":"events",text:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f",children:Object(h.jsx)(b.a,{})}),Object(h.jsx)(l.v,{onClick:F,selected:"messages"===r,"data-story":"messages",text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",children:Object(h.jsx)(d.a,{})}),Object(h.jsx)(l.v,{onClick:F,selected:"profile"===r,"data-story":"profile",text:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",children:Object(h.jsx)(O.a,{})})]}),children:[Object(h.jsx)(l.w,{id:"events",activePanel:"events",children:Object(h.jsx)(l.k,{id:"events",children:Object(h.jsx)(x,{})})}),Object(h.jsxs)(l.w,{id:"messages",activePanel:m,children:[Object(h.jsx)(l.k,{id:"messages",children:Object(h.jsx)(v,{children:Object(h.jsx)(p,{onChatOpen:function(e){E(e),g("chat"),T(!1)}})})}),Object(h.jsx)(l.k,{id:"chat",className:"chatPanel",children:Object(h.jsx)(P,{chat:C,children:Object(h.jsx)(L,{onClose:function(){g("messages"),T(!0)}})})})]}),Object(h.jsx)(l.w,{id:"profile",activePanel:"profile",children:Object(h.jsx)(l.k,{id:"profile",children:Object(h.jsx)(w,{})})})]})})})})})})};j.a.send("VKWebAppInit"),a.a.render(Object(h.jsx)(_,{}),document.getElementById("root"))}},[[171,1,2]]]);
//# sourceMappingURL=main.b3296bfa.chunk.js.map